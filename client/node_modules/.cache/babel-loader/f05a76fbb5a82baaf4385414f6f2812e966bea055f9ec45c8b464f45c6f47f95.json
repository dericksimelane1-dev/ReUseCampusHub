{"ast":null,"code":"import React,{useEffect,useState}from'react';import{BrowserRouter as Router,Routes,Route,Navigate}from'react-router-dom';import{jwtDecode}from'jwt-decode';import Navbar from'./components/Navbar';import Login from'./components/Login';import Signup from'./components/Signup';import ForgotPassword from'./components/ForgotPassword';import ResetPassword from'./components/ResetPassword';import ItemList from'./components/ItemList';import MapView from'./components/MapView';import Messages from'./components/Messages';import EcoPoints from'./components/EcoPoints';import Dashboard from'./components/Dashboard';import ProtectedRoute from'./components/ProtectedRoute';import MessageInbox from'./components/MessageInbox';import'leaflet/dist/leaflet.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function App(){const[isAuthenticated,setIsAuthenticated]=useState(false);const[currentUserId,setCurrentUserId]=useState(null);const[isAdmin,setIsAdmin]=useState(false);useEffect(()=>{const checkAuth=()=>{const token=localStorage.getItem('token');if(token&&token.split('.').length===3){try{const decoded=jwtDecode(token);setIsAuthenticated(true);setCurrentUserId(decoded.id);}catch(err){console.error('Invalid token:',err);setIsAuthenticated(false);}}else{setIsAuthenticated(false);}};checkAuth();// Initial check\nwindow.addEventListener('storage',checkAuth);// Listen for changes\nreturn()=>{window.removeEventListener('storage',checkAuth);};},[]);return/*#__PURE__*/_jsxs(Router,{children:[isAuthenticated&&/*#__PURE__*/_jsx(Navbar,{}),/*#__PURE__*/_jsxs(Routes,{children:[/*#__PURE__*/_jsx(Route,{path:\"/\",element:isAuthenticated?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"}):/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/login\",element:isAuthenticated?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"}):/*#__PURE__*/_jsx(Login,{})}),/*#__PURE__*/_jsx(Route,{path:\"/signup\",element:isAuthenticated?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"}):/*#__PURE__*/_jsx(Signup,{})}),/*#__PURE__*/_jsx(Route,{path:\"/forgot-password\",element:isAuthenticated?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"}):/*#__PURE__*/_jsx(ForgotPassword,{})}),/*#__PURE__*/_jsx(Route,{path:\"/reset-password\",element:isAuthenticated?/*#__PURE__*/_jsx(Navigate,{to:\"/dashboard\"}):/*#__PURE__*/_jsx(ResetPassword,{})}),/*#__PURE__*/_jsx(Route,{path:\"/dashboard\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isAuthenticated:isAuthenticated,children:/*#__PURE__*/_jsx(Dashboard,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/items\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isAuthenticated:isAuthenticated,children:/*#__PURE__*/_jsx(ItemList,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/map\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isAuthenticated:isAuthenticated,children:/*#__PURE__*/_jsx(MapView,{})})}),/*#__PURE__*/_jsx(Route,{path:\"/messages\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isAuthenticated:isAuthenticated,children:/*#__PURE__*/_jsx(MessageInbox,{currentUserId:currentUserId})})}),/*#__PURE__*/_jsx(Route,{path:\"/messages/:itemId/:receiverId\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isAuthenticated:isAuthenticated,children:/*#__PURE__*/_jsx(Messages,{currentUserId:currentUserId})})}),/*#__PURE__*/_jsx(Route,{path:\"/eco-points\",element:/*#__PURE__*/_jsx(ProtectedRoute,{isAuthenticated:isAuthenticated,children:/*#__PURE__*/_jsx(EcoPoints,{})})})]})]});}export default App;","map":{"version":3,"names":["React","useEffect","useState","BrowserRouter","Router","Routes","Route","Navigate","jwtDecode","Navbar","Login","Signup","ForgotPassword","ResetPassword","ItemList","MapView","Messages","EcoPoints","Dashboard","ProtectedRoute","MessageInbox","jsx","_jsx","jsxs","_jsxs","App","isAuthenticated","setIsAuthenticated","currentUserId","setCurrentUserId","isAdmin","setIsAdmin","checkAuth","token","localStorage","getItem","split","length","decoded","id","err","console","error","window","addEventListener","removeEventListener","children","path","element","to"],"sources":["C:/Users/dericks.MIDMUNIC/Documents/ReUseCampusHub/client/src/App.js"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { BrowserRouter as Router, Routes, Route, Navigate } from 'react-router-dom';\r\nimport { jwtDecode } from 'jwt-decode';\r\n\r\nimport Navbar from './components/Navbar';\r\nimport Login from './components/Login';\r\nimport Signup from './components/Signup';\r\nimport ForgotPassword from './components/ForgotPassword';\r\nimport ResetPassword from './components/ResetPassword';\r\nimport ItemList from './components/ItemList';\r\nimport MapView from './components/MapView';\r\nimport Messages from './components/Messages';\r\nimport EcoPoints from './components/EcoPoints';\r\nimport Dashboard from './components/Dashboard';\r\nimport ProtectedRoute from './components/ProtectedRoute';\r\nimport MessageInbox from './components/MessageInbox';\r\n\r\n\r\n\r\n\r\n\r\nimport 'leaflet/dist/leaflet.css';\r\n\r\nfunction App() {\r\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\r\n  const [currentUserId, setCurrentUserId] = useState(null);\r\n  const [isAdmin, setIsAdmin] = useState(false);\r\n\r\n\r\nuseEffect(() => {\r\n    const checkAuth = () => {\r\n      const token = localStorage.getItem('token');\r\n      if (token && token.split('.').length === 3) {\r\n        try {\r\n          const decoded = jwtDecode(token);\r\n          setIsAuthenticated(true);\r\n          setCurrentUserId(decoded.id);\r\n        } catch (err) {\r\n          console.error('Invalid token:', err);\r\n          setIsAuthenticated(false);\r\n        }\r\n      } else {\r\n        setIsAuthenticated(false);\r\n      }\r\n    };\r\n\r\n    checkAuth(); // Initial check\r\n    window.addEventListener('storage', checkAuth); // Listen for changes\r\n\r\n    return () => {\r\n      window.removeEventListener('storage', checkAuth);\r\n    };\r\n  }, []);\r\n\r\n\r\n  return (\r\n    <Router>\r\n      {isAuthenticated && <Navbar />}\r\n      <Routes>\r\n        <Route path=\"/\" element={isAuthenticated ? <Navigate to=\"/dashboard\" /> : <Login />} />\r\n        <Route path=\"/login\" element={isAuthenticated ? <Navigate to=\"/dashboard\" /> : <Login />} />\r\n        <Route path=\"/signup\" element={isAuthenticated ? <Navigate to=\"/dashboard\" /> : <Signup />} />\r\n        <Route path=\"/forgot-password\" element={isAuthenticated ? <Navigate to=\"/dashboard\" /> : <ForgotPassword />} />\r\n        <Route path=\"/reset-password\" element={isAuthenticated ? <Navigate to=\"/dashboard\" /> : <ResetPassword />} />\r\n\r\n\r\n        <Route path=\"/dashboard\" element={\r\n          <ProtectedRoute isAuthenticated={isAuthenticated}>\r\n            <Dashboard />\r\n          </ProtectedRoute>\r\n        } />\r\n        <Route path=\"/items\" element={\r\n          <ProtectedRoute isAuthenticated={isAuthenticated}>\r\n            <ItemList />\r\n          </ProtectedRoute>\r\n        } />\r\n        <Route path=\"/map\" element={\r\n          <ProtectedRoute isAuthenticated={isAuthenticated}>\r\n            <MapView />\r\n          </ProtectedRoute>\r\n        } />\r\n        <Route path=\"/messages\" element={\r\n          <ProtectedRoute isAuthenticated={isAuthenticated}>\r\n            <MessageInbox currentUserId={currentUserId} />\r\n          </ProtectedRoute>\r\n        } />\r\n        <Route path=\"/messages/:itemId/:receiverId\" element={\r\n          <ProtectedRoute isAuthenticated={isAuthenticated}>\r\n            <Messages currentUserId={currentUserId} />\r\n          </ProtectedRoute>\r\n        } />\r\n        <Route path=\"/eco-points\" element={\r\n          <ProtectedRoute isAuthenticated={isAuthenticated}>\r\n            <EcoPoints />\r\n          </ProtectedRoute>\r\n        } />\r\n\r\n      </Routes>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}